<!doctype html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Creator Micro Mapper</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="app">
      <header class="app-header">
        <h1>Creator Micro Mapper</h1>
        <p>
          Configura il tuo Work Louder Creator Micro in modo semplice: scegli
          tasti con nomi leggibili, crea scorciatoie, assegna macro.
        </p>
      </header>

      <section class="panel controls-panel">
        <h2>Profile</h2>
        <div class="field-group">
          <label for="profileName">Profile Name</label>
          <input id="profileName" type="text" placeholder="My Creator Micro Profile" />
        </div>

        <div class="field-row">
          <div class="field-group">
            <label for="layerSelect">Layer</label>
            <select id="layerSelect"></select>
          </div>
          <div class="field-group">
            <label for="keyCount">Key Count</label>
            <input id="keyCount" type="number" min="1" max="64" />
          </div>
        </div>

        <div class="button-row">
          <button id="saveLocalButton" type="button">Save Local</button>
          <button id="loadLocalButton" type="button">Load Local</button>
          <button id="resetButton" type="button" class="danger">Reset</button>
        </div>

        <div class="button-row">
          <button id="exportButton" type="button">Export JSON</button>
          <label class="file-label" for="importInput">Import JSON</label>
          <input id="importInput" type="file" accept="application/json" />
        </div>

        <p id="statusMessage" class="status"></p>
      </section>

      <section class="panel layout-panel">
        <h2>Keyboard Layout</h2>
        <p class="hint">Select a key to edit its action.</p>
        <div id="keyGrid" class="key-grid"></div>
      </section>

      <section class="panel editor-panel">
        <h2>Key Editor</h2>
        <p id="selectedKeyLabel">No key selected.</p>
        <p class="hint">
          Modalita semplice: seleziona i tasti con nomi normali. I codici VIA
          restano disponibili solo in "Avanzato".
        </p>

        <div class="field-group">
          <label for="actionType">Action Type</label>
          <select id="actionType">
            <option value="keycode">Tasto singolo</option>
            <option value="shortcut">Scorciatoia</option>
            <option value="macro">Macro</option>
          </select>
        </div>

        <div id="keycodeFields" class="editor-section">
          <div class="field-group">
            <label for="keycodeSelect">Tasto (layout ITA)</label>
            <select id="keycodeSelect"></select>
          </div>
          <details class="advanced-details">
            <summary>Avanzato: codice VIA/QMK</summary>
            <div class="field-group compact">
              <label for="keycodeInput">Codice raw</label>
              <input id="keycodeInput" type="text" placeholder="KC_A" />
            </div>
          </details>
        </div>

        <div id="shortcutFields" class="editor-section hidden">
          <p class="hint">
            Crea la scorciatoia in modo visuale (esempio: Ctrl + Maiusc + S).
          </p>
          <div class="checkbox-row">
            <label><input type="checkbox" value="LCTL" class="modifier" />Ctrl</label>
            <label><input type="checkbox" value="LSFT" class="modifier" />Maiusc</label>
            <label><input type="checkbox" value="LALT" class="modifier" />Alt</label>
            <label><input type="checkbox" value="LGUI" class="modifier" />Cmd / Win</label>
          </div>
          <div class="field-group">
            <label for="shortcutKeySelect">Tasto principale (layout ITA)</label>
            <select id="shortcutKeySelect"></select>
          </div>
          <details class="advanced-details">
            <summary>Avanzato: base keycode raw</summary>
            <div class="field-group compact">
              <label for="shortcutKeyInput">Base raw</label>
              <input id="shortcutKeyInput" type="text" placeholder="KC_C" />
            </div>
          </details>
          <div class="field-group">
            <label for="shortcutFriendlyPreview">Scorciatoia leggibile</label>
            <input id="shortcutFriendlyPreview" type="text" readonly />
          </div>
          <div class="field-group">
            <label for="shortcutPreview">Codice VIA generato</label>
            <input id="shortcutPreview" type="text" readonly />
          </div>
        </div>

        <div id="macroFields" class="editor-section hidden">
          <div class="field-group">
            <label for="macroSelect">Macro</label>
            <select id="macroSelect"></select>
          </div>
        </div>
      </section>

      <section class="panel macro-panel">
        <h2>Macros</h2>
        <p class="hint">
          Composer visuale: costruisci la macro a step (tasto, scorciatoia,
          testo, pausa) senza scrivere codici.
        </p>
        <div id="macroList" class="macro-list"></div>
        <button id="addMacroButton" type="button">Aggiungi macro</button>
      </section>

      <section class="panel output-panel">
        <h2>Export Preview</h2>
        <p class="hint">
          This JSON captures your key assignments and macros for later import.
        </p>
        <textarea id="jsonPreview" readonly></textarea>
      </section>
    </main>

    <script src="./app.js"></script>
  </body>
</html>
